{% extends 'base.html' %}

{% block uncontained_content %}
  {% include "header.html" %}
{% endblock %}

{% block content %}
<div class="card">
<h1>SEND MESSAGES</h1>
</div>
<br>

<div id="sendto_person_profile"> </div>

<div class="card">
		<label>Message:</label>
    <textarea name="message" id="message" rows="10" placeholder="Nice knowing you! I hope you will find happiness and success in life."></textarea>
    <button onclick="send_message()" class="btn">Sign Yearbook</button>
</div>

<script charset="utf-8">
  let sendToUUID = urlParams.get("sendto");
  $.get("/view_profile", {"uuid": sendToUUID}, function(data){
      let currentCard = $("<div class='face-card' style='height: auto'></div>");
      currentCard.append($(`<img id="img_${data.name}" alt="profile picture missing" src="${pfp_path}/${sendToUUID}.png" onerror="this.onerror=null;this.src='${pfp_path}/panda.png';"></img>`));

      let nameText = $(`<h2></h2>`);
      nameText.text(data.name);
      currentCard.append(nameText);
      let bioText = $("<p></p>");
      bioText.text(data.bio);
      currentCard.append(bioText);
      $("#sendto_person_profile").append(currentCard);
  });

  function send_message(){
    $.post("/send_message", {
    "sendto": urlParams.get("sendto"),
    "message": $("#message").val()
    }, (data)=>{
      window.location.href = data;
    });
  }

</script>

{% endblock %}
