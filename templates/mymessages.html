{% extends 'base.html' %}

{% block uncontained_content %}
  {% include "header.html" %}
{% endblock %}


{% block head %}
<style>
  #content {
    min-height: 100%;
  }
</style>


<link rel="stylesheet" href="{{url_for('static', filename='stickies.css')}}" type="text/css" >
{% endblock %}

{% block content %}
<div id="myprofile">

</div>

<div class="card">
  <h1>messages:</h1>
</div>
<div id="messages">
  <ul id="stick">

  </ul>

</div>

<script type="text/javascript">

$.get("/get_uuid", function(uuid){
  $.get("/view_profile", {"uuid": uuid}, function(data){
    let currentCard = $("<div class='face-card' style='height:auto'></div>");
    currentCard.append($(`<img id="img_${uuid}" alt="profile picture missing" src="${pfp_path}/${uuid}.png" onerror="this.onerror=null;this.src='${pfp_path}/panda.png';"></img>`));

    let nameText = $("<h2></h2>");
    nameText.text(data.name);
    currentCard.append(nameText);

    let bioText = $("<p></p>");
    bioText.text(data.bio);
    currentCard.append(bioText);
    $("#myprofile").append(currentCard);
  });
});

$.get("/view_my_messages", function(data){
  if(data == "no messages"){
    $.notify("no messages yet");
  }
  else{
    let allCards = $("<ul id='stick'></ul>");
    for(let sender_person in data){
      let currentCard = $("<div class='sticky'></div>");
      currentCard.append($(`<h2>messages from ${sender_person}</h2>`));
      for(let message in data[sender_person]){
        currentCard.append($(`<p>message: ${data[sender_person][message]}</p>`));
      }
      let currentSticky = $("<li></li>");
      currentSticky.append(currentCard);
      $("#stick").append(currentSticky);
    }
  }
});
</script>

{% endblock %}
